!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.typoExt=t():e.typoExt=t()}(self,(()=>(()=>{"use strict";var e={};return{654:function(e,t){var s=this&&this.__awaiter||function(e,t,s,o){return new(s||(s=Promise))((function(n,i){function r(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?n(e.value):(t=e.value,t instanceof s?t:new s((function(e){e(t)}))).then(r,a)}c((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TypoXApiHost=t.TypoXApiClient=void 0,t.TypoXApiClient=class{constructor(){this.requests=0;const e=new MessageChannel;this.port=e.port1,window.postMessage(e.port2,"*",[e.port2])}request(e){return s(this,void 0,void 0,(function*(){return new Promise(((t,s)=>{const o=this.requests++,n=e=>{const i=e.data;console.info("[XAPI] ðŸ †  received ",i),i.id==o&&(this.port.removeEventListener("message",n),i.found?t(i.resource):s("Resource could not be found"))};this.port.addEventListener("message",n);const i={id:o,resource:e};this.port.postMessage(i)}))}))}},t.TypoXApiHost=class{constructor(){this.messageChannels=[],this.access={addMessage:addChatMessage,commands:{add:e=>{e.forEach((t=>{if(e.some((e=>e.command==t.command)))throw new Error("Command did already exist: "+t.command);e.push(t)}))},remove:e=>{e.forEach((t=>{let s=e.findIndex((e=>e.command==t.command));s&&e.splice(s,1)}))}}},this.listen()}listen(){window.addEventListener("message",(e=>{if(e.data instanceof MessagePort){console.info("[XAPI] new listener added");const t=e.data;this.messageChannels.push(t),t.onmessage=e=>{const s=e.data;console.info("[XAPI] ðŸ „  requested ",s);let o=this.access[s.resource];const n={id:s.id,resource:o,found:!1};null!=o&&(n.found=!0),t.postMessage(n)}}}))}}}}[654](0,e),e})()));