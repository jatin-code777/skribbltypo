!function(e,t){"object"==typeof exports&&"object"==typeof module?module.exports=t():"function"==typeof define&&define.amd?define([],t):"object"==typeof exports?exports.typoExt=t():e.typoExt=t()}(self,(()=>(()=>{"use strict";var e={654:function(e,t){var n=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(s,i){function r(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}c((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TypoXApiHost=t.TypoXApiClient=void 0,t.TypoXApiClient=class{constructor(){this.requests=0;const e=new MessageChannel;this.port=e.port1,window.postMessage(e.port2,"*",[e.port2])}request(e){return n(this,void 0,void 0,(function*(){return new Promise(((t,n)=>{const o=this.requests++,s=e=>{const i=e.data;console.info("[XAPI] ðŸ †  received ",i),i.id==o&&(this.port.removeEventListener("message",s),i.found?t(i.resource):n("Resource could not be found"))};this.port.addEventListener("message",s);const i={id:o,resource:e};this.port.postMessage(i)}))}))}},t.TypoXApiHost=class{constructor(){this.messageChannels=[],this.access={addMessage:addChatMessage,commands:{add:e=>{e.forEach((t=>{if(e.some((e=>e.command==t.command)))throw new Error("Command did already exist: "+t.command);e.push(t)}))},remove:e=>{e.forEach((t=>{let n=e.findIndex((e=>e.command==t.command));n&&e.splice(n,1)}))}}},this.listen()}listen(){window.addEventListener("message",(e=>{if(e.data instanceof MessagePort){console.info("[XAPI] new listener added");const t=e.data;this.messageChannels.push(t),t.onmessage=e=>{const n=e.data;console.info("[XAPI] ðŸ „  requested ",n);let o=this.access[n.resource];const s={id:n.id,resource:o,found:!1};null!=o&&(s.found=!0),t.postMessage(s)}}}))}}},894:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(s,i){function r(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}c((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TimerExtension=void 0;const s=n(810);class i extends s.TypoExtension{onInit(){console.log("Method not implemented.")}onDestroy(){console.log("Method not implemented.")}constructor(){super(),this.extensionCommands=[{command:"timer",options:{type:"action",description:"Starts a new timer. Usage: timer [seconds] [message]",actionBefore:null,actionEnable:null,actionDisable:null,actionAfter:e=>{const t=this.parseTimerArguments(e);setTimeout((()=>o(this,void 0,void 0,(function*(){(yield this.request("addChatMessage"))("Timer is due!",t.message)}))),1e3*t.time)},response:e=>`Started new timer for ${this.parseTimerArguments(e).time}s.`}}]}parseTimerArguments(e){let t=Number(e.split(" ")[0]);return Number.isNaN(t)&&(t=60),{time:t,message:e.split(" ").slice(1).join(" ")}}}t.TimerExtension=i},810:function(e,t,n){var o=this&&this.__awaiter||function(e,t,n,o){return new(n||(n=Promise))((function(s,i){function r(e){try{c(o.next(e))}catch(e){i(e)}}function a(e){try{c(o.throw(e))}catch(e){i(e)}}function c(e){var t;e.done?s(e.value):(t=e.value,t instanceof n?t:new n((function(e){e(t)}))).then(r,a)}c((o=o.apply(e,t||[])).next())}))};Object.defineProperty(t,"__esModule",{value:!0}),t.TypoExtension=void 0;const s=n(654);t.TypoExtension=class{constructor(){this.extensionCommands=[],this.apiClient=new s.TypoXApiClient}request(e){return o(this,void 0,void 0,(function*(){return this.apiClient.request(e)}))}initExtension(){this.onInit(),this.extensionCommands.length>0&&this.request("commands").then((e=>{this.extensionCommands.forEach((t=>{if(e.some((e=>e.command==t.command)))throw new Error("Command did already exist: "+t.command);e.push(t)}))}))}destroyExtension(){this.onDestroy(),this.extensionCommands.length>0&&this.request("commands").then((e=>{this.extensionCommands.forEach((t=>{let n=e.findIndex((e=>e.command==t.command));n&&e.splice(n,1)}))}))}}}},t={};return function n(o){var s=t[o];if(void 0!==s)return s.exports;var i=t[o]={exports:{}};return e[o].call(i.exports,i,i.exports,n),i.exports}(894)})()));